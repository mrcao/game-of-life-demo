<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Game of Life (Python + PyScript)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <!-- PyScript (2024.x) -->
  <link rel="stylesheet" href="https://pyscript.net/releases/2024.6.1/core.css">
  <script type="module" src="https://pyscript.net/releases/2024.6.1/core.js"></script>
  <style>
    body { font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial; margin: 0; background:#0b0f13; color:#e6edf3}
    header { padding: 12px 16px; border-bottom: 1px solid #18212a; display:flex; align-items:center; gap:12px}
    .brand { font-weight:700; letter-spacing:0.3px }
    .wrap { display:flex; gap:16px; padding:16px; align-items:flex-start; }
    .canvas-container { 
      background:#0f141a; 
      border:1px solid #1c2733; 
      border-radius:14px; 
      padding:12px;
      width: 744px;  /* 720px canvas + 12px padding each side */
      height: 744px;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0; /* Prevent container from shrinking */
    }
    .controls-container {
      background:#0f141a; 
      border:1px solid #1c2733; 
      border-radius:14px; 
      padding:12px;
      width: 380px;
      flex-shrink: 0; /* Prevent controls from moving */
    }
    #board { background:#0a0d12; border:1px solid #1c2733; border-radius:8px; display:block }
    .controls { display:flex; flex-direction:column; gap:12px; }
    .control { background:#0b1218; border:1px solid #1a2531; border-radius:10px; padding:10px }
    label { font-size:12px; color:#b7c1c9; display:block; margin-bottom:6px }
    input[type="range"]{ width:100% }
    button { background:#1c2733; color:#e6edf3; border:1px solid #2a3a4a; border-radius:10px; padding:8px 10px; cursor:pointer; transition: all 0.2s }
    button:hover{ background:#223447 }
    .play-btn.playing { background:#28a745; border-color:#34ce57 }
    .play-btn.playing:hover { background:#239a3e }
    .play-btn.paused { background:#6c757d; border-color:#868e96 }
    .play-btn.dead { background:#6c757d; border-color:#868e96 }
    .status-display { 
      margin-top: 10px; 
      padding: 8px 10px; 
      border-radius: 6px; 
      font-size: 13px; 
      font-weight: 500;
      text-align: center;
      min-height: 20px;
      transition: opacity 0.3s ease-out;
    }
    .status-display.hidden { opacity: 0; }
    .row { display:flex; gap:8px; align-items:center; flex-wrap:wrap }
    .pill { padding:4px 8px; border-radius:999px; background:#13202b; border:1px solid #243245; font-size:12px; color:#c4d0d9 }
    .muted { color:#9fb0bd; font-size:12px }
    a { color:#7db7ff; text-decoration:none }
    .number-input {
      width: auto;
      min-width: 30px;
      max-width: 50px;
      background: transparent;
      border: none;
      border-bottom: 1px solid transparent;
      color: #e6edf3;
      padding: 2px 4px;
      font-size: 13px;
      text-align: center;
      transition: all 0.2s;
      cursor: pointer;
    }
    .number-input:hover {
      border-bottom-color: #4a5968;
    }
    .number-input:focus {
      outline: none;
      background: #1a2531;
      border: 1px solid #4a90e2;
      border-radius: 4px;
      cursor: text;
    }
    /* Hide spinner arrows in number inputs */
    .number-input::-webkit-outer-spin-button,
    .number-input::-webkit-inner-spin-button {
      -webkit-appearance: none;
      appearance: none;
      margin: 0;
    }
    .number-input[type=number] {
      -moz-appearance: textfield;
      appearance: textfield;
    }
    @media (max-width: 1200px) {
      .wrap { flex-direction: column; align-items: center; }
      .canvas-container, .controls-container { width: auto; max-width: 100%; }
    }
  </style>
  <py-config>
    [[fetch]]
    files = ["life/engine.py", "life/utils.py", "app.py"]
  </py-config>
</head>
<body>
  <header>
    <div class="brand">Conway's Game of Life</div>
    <span class="pill">Python · PyScript · Canvas</span>
    <span class="muted">Click cells to toggle • Works on GitHub Pages</span>
    <span style="flex:1"></span>
    <a href="https://github.com/yourname/game-of-life" target="_blank">View Repo</a>
  </header>

  <div class="wrap">
    <div class="canvas-container">
      <canvas id="board" width="720" height="720"></canvas>
    </div>

    <div class="controls-container">
      <div class="controls">
        <div class="control">
          <label>Main Controls</label>
          <div class="row">
            <button id="playPause" class="play-btn">▶ Play</button>
            <button id="step">Step</button>
            <button id="clear">Clear</button>
            <button id="seed">Randomize</button>
            <button id="noise">Inject Noise</button>
          </div>
          <div id="statusDisplay" class="status-display"></div>
        </div>

        <div class="control">
          <label for="speed">Speed</label>
          <div class="row">
            <input id="speed" type="range" min="5" max="600" value="100" style="flex:1" />
            <input id="speedInput" type="number" min="5" max="600" value="100" class="number-input" />
            <span class="muted">ms</span>
          </div>
        </div>

        <div class="control">
          <label for="gridSize">Grid Size</label>
          <div class="row">
            <input id="gridSize" type="range" min="2" max="240" value="80" style="flex:1" />
            <input id="gridSizeInput" type="number" min="2" max="240" value="80" class="number-input" />
            <span class="muted">×</span>
            <span class="muted" id="gridSizeVal">80</span>
          </div>
        </div>

        <div class="control">
          <label for="density">Seed Density</label>
          <div class="row">
            <input id="density" type="range" min="0" max="99" value="15" style="flex:1" />
            <span class="muted">0.</span>
            <input id="densityInput" type="number" min="0" max="99" value="15" class="number-input" />
          </div>
        </div>

        <div class="control">
          <label>Auto-Perturb Settings</label>
          <div style="margin-bottom:8px">
            <label class="row" style="gap:6px">
              <input id="autoPerturb" type="checkbox" />
              <span>Enable auto-perturb</span>
            </label>
          </div>
          <div class="row">
            <label style="font-size:11px; color:#9fb0bd; flex:1">Perturb rate</label>
            <input id="perturbRate" type="range" min="0" max="100" value="30" style="flex:2" />
            <input id="perturbRateInput" type="number" min="0" max="100" value="30" class="number-input" style="max-width:40px" />
            <span class="muted">%</span>
          </div>
        </div>

        <div class="control">
          <label>Other Settings</label>
          <div class="row" style="gap:14px; flex-direction:column; align-items:flex-start">
            <label class="row" style="gap:6px">
              <input id="toroidal" type="checkbox" checked />
              <span>Toroidal wrapping</span>
            </label>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <div style="padding: 16px; text-align: center;">
    <span class="muted">Tip: If the board freezes into a loop or still life, try "Inject Noise" or enable "Auto-perturb."</span>
  </div>

  <py-script src="app.py"></py-script>
</body>
</html>

